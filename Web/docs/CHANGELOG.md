# 更新日志

本文档记录 NotesApplication 项目的所有重要变更。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [1.0.1] - 2025-06-13

这是一个重要的修复版本，解决了笔记格式转换功能的关键问题。

### 修复
- **笔记格式转换系统**
  - 🔧 修复了"标注"格式转换后无法转换回其他格式的严重bug
  - 🔧 解决了转换为"文本"时无法彻底清除宏观格式的问题
  - 🔧 修复了无序列表和有序列表格式转换异常
  - 🔧 **核心修复**：解决了格式转换后几秒钟自动回滚的关键问题
  - 🔧 修复了应用启动时的环境变量加载错误

### 新增
- 规范化的更新日志文档格式。
- 图标使用规范集成到开发规范文档。
- 统一的变更记录机制。

### 改进
- 开发规范文档结构优化。
- 代码质量检查工具集成。

### 修复
- **编辑器稳定性**
  - 修复了笔记编辑时光标跳跃和内容消失的问题。
  - 优化了 `TipTapEditor` 的内容同步逻辑，以避免在用户编辑状态下重置编辑器内容。
  - 解决了因循环更新（具体流程：用户输入 → `onUpdate` → `handleNoteUpdateFromEditor` → `updateNote` → `setNotes` → 重新渲染 → `useEffect` 重置内容）导致的编辑体验不佳问题。
  - 通过增加编辑状态检查和内容比较优化，确保了编辑过程的流畅性。

### 改进
- **编辑器稳定性**
  - ✨ 添加了格式转换状态管理机制
  - ✨ 优化了 TipTap 编辑器的自动更新逻辑
  - ✨ 实现了智能格式状态检查和冲突避免
  - ✨ 增强了格式转换命令的执行精确度

### 技术细节
- **新增依赖**: `@tiptap/extension-highlight` - 支持文本高亮功能
- **核心机制**: 实现了格式转换期间的自动更新暂停机制
- **状态管理**: 使用 `useRef` 维护格式转换状态，防止更新冲突

### 影响范围
- ✅ 所有笔记格式转换功能现已完全稳定
- ✅ 环境变量配置问题已解决
- ✅ 编辑器性能和稳定性显著提升

## [1.0.0] - 2025-06-04

### 新增
- **核心功能**
  - React + Vite 前端应用架构
  - Flask + SQLAlchemy 后端 API
  - SQLite 数据库支持
  - 文件夹层次结构管理
  - 笔记CRUD操作
  - 拖拽排序功能

- **AI 功能**
  - LangChain + 通义千问集成
  - 智能内容优化
  - AI 驱动的笔记增强

- **用户界面**
  - Material-UI 组件库
  - 响应式设计
  - 深色/浅色主题支持
  - 实时预览功能

- **开发工具**
  - Docker 容器化支持
  - 代码标准检查工具
  - 开发规范文档
  - 自动化构建流程

### 技术栈
- **前端**: React 18 + Vite + Material-UI
- **后端**: Python 3.12 + Flask + SQLAlchemy
- **AI服务**: LangChain + 通义千问(Qwen)
- **数据库**: SQLite
- **容器化**: Docker + Docker Compose

## [0.0.5] - 2025-03-30

### 新增
- **编辑器框架升级**
  - 从 ReactMarkdown 迁移至 TipTap Editor
  - 增强富文本编辑功能
  - 行内 Markdown 语法实时渲染
  - 支持更多 Markdown 扩展语法

- **笔记块功能增强**
  - 笔记块快捷操作工具栏
  - 快速内容复制功能
  - 笔记块删除功能
  - 多种格式转换选项

### 改进
- **交互体验优化**
  - 回车键快速创建新笔记块
  - 笔记块间过渡动画
  - 笔记块选择和焦点管理
  - 整体操作流畅度提升

- **性能优化**
  - 编辑器渲染性能优化
  - 大型文档加载速度改进
  - 减少不必要的重渲染
  - 内存使用优化

## [0.0.4] - 2025-03-03

### 新增
- **Ubuntu 部署支持**
  - Ubuntu 部署文档 (DEPLOY_UBUNTU.md)
  - EC2 环境配置步骤
  - 外部访问配置指南
  - 常见问题解决方案

### 改进
- **部署流程优化**
  - 简化环境依赖安装
  - 优化项目配置管理
  - 改进服务启动脚本
  - 增强安全性配置

### 文档
- **部署文档完善**
  - 详细环境要求说明
  - 配置步骤描述优化
  - 故障排除指南
  - 性能优化建议

## [0.0.3] - 2025-03-02

### 新增
- **笔记文件拖拽功能**
  - 长按触发拖拽操作
  - 实时排序视觉反馈
  - 服务端排序持久化
  - 错误处理和回滚机制

### 改进
- 拖拽过程性能优化

## [0.0.2] - 2025-03-01

### 新增
- **左侧导航栏**
  - 层级目录结构
  - 章节折叠功能
  - 平滑滚动定位
  - 键盘导航支持

- **文档同步工具增强**
  - sync_readme.py 重命名为 sync_docs.py
  - CHANGELOG 文件同步支持
  - 中英文内容提取和合并逻辑改进
  - 文件变更检测防抖处理

- **笔记文件管理**
  - 快速删除笔记功能
  - 删除操作即时视觉反馈
  - 删除后状态更新和界面刷新

### 改进
- **项目架构优化**
  - 后端模块化设计 (models、routes 分离)
  - 数据库模型结构优化
  - API 接口设计规范化
  - 前端组件化开发
  - hooks 和 services 分层设计
  - 配置文件管理系统

- **用户体验优化**
  - 文件名重复自动处理
  - 编辑器状态切换平滑过渡
  - 拖拽指示器位置计算优化
  - 乐观更新策略

### 修复
- 高频 API 请求问题 (搜索防抖、请求取消)
- 拖拽排序数据同步问题
- 拖拽视觉反馈和过渡动画

### 文档
- 错误日志记录功能 (ERROR_LOG.md)
- 结构化错误日志实现

## [0.0.1] - 2025-02-28

### 新增
- **基础笔记管理**
  - 笔记创建、编辑、删除
  - 笔记拖拽排序
  - Markdown 编辑和实时预览

- **前后端分离架构**
  - React + Material-UI 前端界面
  - Flask 后端 API
  - SQLite 数据持久化

- **性能优化**
  - 笔记内容实时保存
  - API 请求防抖优化
  - 笔记列表渲染性能优化

---

## 变更类型说明

- **新增** - 新功能
- **改进** - 对现有功能的改进
- **修复** - 错误修复
- **移除** - 移除的功能
- **安全** - 安全相关的修复
- **文档** - 文档更新
- **重构** - 代码重构，不影响功能

## 版本号规则

本项目采用语义化版本号 `MAJOR.MINOR.PATCH`:

- **MAJOR**: 不兼容的 API 修改
- **MINOR**: 向下兼容的功能性新增
- **PATCH**: 向下兼容的问题修正